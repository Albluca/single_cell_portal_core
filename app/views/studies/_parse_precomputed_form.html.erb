<div class="bs-callout bs-callout-default">
	<h4>Parse uploaded file <span class="label label-info">Marker Genes</span></h4>
	<%= form_for(:precomputed, url: launch_parse_job_study_path(@study._id), html: {class: 'form', remote: true, id: "#{study_file._id}_parse"}) do |f| %>
		<div class="form-group row">
			<div class="col-md-4">
				<%= f.label :precomputed_file, 'Marker Gene List file' %><br />
				<p><%= render partial: '/layouts/download_link', locals: {study_file: study_file, study: @study} %></p>
				<%= f.hidden_field :precomputed_file, value: study_file.name, class: 'form-control' %>
			</div>
			<div class="col-md-6">
				<%= f.label :precomputed_name, "Name of gene list <span class='fa fa-question-circle' data-toggle='tooltip' title='Display name used to label this marker gene list in menus and pages'></span>".html_safe %><br />
				<%= f.text_field :precomputed_name, class: 'form-control' %>
			</div>
			<div class="col-md-2">
				<%= f.label :parse, 'Actions' %><br />
				<%= f.submit 'Parse', class: 'btn btn-info parse-study-file loading', disabled: study_file.parse_status != 'unparsed'  %>
				<%= render partial: 'refresh_link', locals: {study_file: study_file} %>
			</div>
		</div>
	<% end %>
</div>

<script type="text/javascript">
	var parser = "#<%= study_file._id %>_parse";

	$(parser).find('.download-btn').click(function() {
		var url = $(this).data('filepath');
		$.get(url);
	});

	// start small spinner on loading functions
	$(parser).find('.loading').click(function() {
		var tgt = $(this)[0];
		new Spinner(smallOpts).spin(tgt);
	});

</script>