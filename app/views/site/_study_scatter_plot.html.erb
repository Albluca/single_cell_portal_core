<% @coordinates.sort_by {|k,v| k}.each_with_index do |(cluster, data), index| %>
	var <%= cluster %> = {
		x: <%= raw data[:x] %>,
		y: <%= raw data[:y] %>,
		text: <%= raw data[:text] %>,
		name: "<%= data[:name] %>",
		mode: 'markers',
		type: 'scatter',
		marker: {
			color: colorBrewerSet[<%= index %>],
			line: {
				color: plotlyDefaultLineColor,
				width: 0.5
			}
		}
	};
<% end %>

var data = [];
<% @clusters.each do |cluster| %>
	data.push(<%= cluster.name %>);
<% end %>

// use partial for layouts to avoid code duplication
<%= render 'study_scatter_layout' %>


<% if params[:cluster] %>
	<%= render 'new_scatter_color_vals' %>
<% end %>

Plotly.newPlot('cluster-plot', data, layout);